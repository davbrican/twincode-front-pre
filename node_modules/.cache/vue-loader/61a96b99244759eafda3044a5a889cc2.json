{"remainingRequest":"F:\\TWINCODE\\twincode-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\TWINCODE\\twincode-front\\src\\pages\\Playground.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\TWINCODE\\twincode-front\\src\\pages\\Playground.vue","mtime":1629196657549},{"path":"F:\\TWINCODE\\twincode-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\TWINCODE\\twincode-front\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\TWINCODE\\twincode-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\TWINCODE\\twincode-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgVnVlIGZyb20gInZ1ZSI7DQppbXBvcnQgTWVzc2FnZSBmcm9tICIuLi9jb21wb25lbnRzL01lc3NhZ2UiOw0KaW1wb3J0IHsgY29kZW1pcnJvciB9IGZyb20gInZ1ZS1jb2RlbWlycm9yIjsNCmltcG9ydCAiY29kZW1pcnJvci9tb2RlL2phdmFzY3JpcHQvamF2YXNjcmlwdC5qcyI7DQppbXBvcnQgImNvZGVtaXJyb3IvbGliL2NvZGVtaXJyb3IuY3NzIjsNCg0KZnVuY3Rpb24gZGJnKG1zZywgb2JqLCBmaWVsZHMpIHsNCiAgDQogIGZ1bmN0aW9uIHJlcGxhY2VyKGtleSwgdmFsdWUpIHsNCiAgICBjb25zdCBvcmlnaW5hbE9iamVjdCA9IHRoaXNba2V5XTsNCiAgICBpZihvcmlnaW5hbE9iamVjdCBpbnN0YW5jZW9mIE1hcCkgew0KICAgICAgcmV0dXJuIHsNCiAgICAgICAgZGF0YVR5cGU6ICdNYXAnLA0KICAgICAgICB2YWx1ZTogQXJyYXkuZnJvbShvcmlnaW5hbE9iamVjdC5lbnRyaWVzKCkpLCANCiAgICAgIH07DQogICAgfSBlbHNlIHsNCiAgICAgIHJldHVybiB2YWx1ZTsNCiAgICB9DQogIH0NCg0KICBpZihvYmopew0KICAgIGlmKGZpZWxkcyAmJiBBcnJheS5pc0FycmF5KGZpZWxkcykpew0KICAgICAgdmFyIGxvZ09iaiA9IHt9Ow0KICAgICAgZm9yIChjb25zdCBmaWVsZCBpbiBvYmopIHsNCiAgICAgICAgaWYoZmllbGRzLmluY2x1ZGVzKGZpZWxkKSkNCiAgICAgICAgICBsb2dPYmpbZmllbGRdID0gb2JqW2ZpZWxkXTsNCiAgICAgIH0gICAgICAgDQogICAgICBjb25zb2xlLmxvZygiREVCVUcgLSAiK21zZysiIDwiK0pTT04uc3RyaW5naWZ5KGxvZ09iaixyZXBsYWNlcikuc2xpY2UoMCwgLTEpKyIsLi4ufT4iKTsgDQogICAgfWVsc2V7DQogICAgICBjb25zb2xlLmxvZygiREVCVUcgLSAiK21zZysiIDwiK0pTT04uc3RyaW5naWZ5KG9iaixyZXBsYWNlcikrIj4iKTsNCiAgICB9DQoNCiAgfSBlbHNlew0KICAgICAgY29uc29sZS5sb2coIkRFQlVHIC0gIittc2cpOw0KICB9DQoNCn0NCg0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7DQogICAgY29kZW1pcnJvciwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgY29kZTogYGAsDQogICAgICBjbU9wdGlvbjogew0KICAgICAgICB0YWJTaXplOiA0LA0KICAgICAgICBzdHlsZUFjdGl2ZUxpbmU6IHRydWUsDQogICAgICAgIGxpbmVOdW1iZXJzOiB0cnVlLA0KICAgICAgICBtb2RlOiAidGV4dC9qYXZhc2NyaXB0IiwNCiAgICAgIH0sDQogICAgICBmaXJzdExvYWQ6IHRydWUsDQogICAgICBhd2FpdGluZzogbnVsbCwNCiAgICAgIGN1cnNvckxlZnRQb3NpdGlvbjogMCwNCiAgICAgIGN1cnNvclRvcFBvc2l0aW9uOiAwLA0KICAgICAgbXlNZXNzYWdlOiAiIiwNCiAgICAgIHVpZDogIiIsDQogICAgICByaWQ6ICIiLA0KICAgICAgbGFzdFJlY2VpdmVkOiAiIiwNCiAgICAgIGV4ZXJjaXNlRGVzY3JpcHRpb246ICJQbGVhc2UsIHdhaXQgdW50aWwgdGhlIGV4ZXJjaXNlIGxvYWRzLi4uIiwNCiAgICAgIGV4ZXJjaXNlTG9hZGVkOiBmYWxzZSwNCiAgICAgIGV4ZXJjaXNlVHlwZTogIlBBSVIiLA0KICAgICAgdGVzdERlc2NyaXB0aW9uOiAiIiwNCiAgICAgIGZpbmlzaGVkOiBmYWxzZSwNCiAgICAgIHN0YXJ0aW5nOiB0cnVlLA0KICAgICAgbG9hZGluZ1Rlc3Q6IGZhbHNlLA0KICAgICAgcGVlckNoYW5nZTogZmFsc2UsDQogICAgICB0aW1lSW50ZXJ2YWw6IG51bGwsDQogICAgICBtYXhUaW1lOiAwLA0KICAgICAgdGltZVBhc3NlZDogMCwNCiAgICAgIGlzRXhlcmNpc2VDb3JyZWN0OiBudWxsLA0KICAgICAgdHdjYzpudWxsLA0KICAgICAgZXhjZXJjaXNlRXJyb3JNZXNzYWdlOiAiIiwNCiAgICAgIHJldHVyblZhbHVlOiAiIiwNCiAgICAgIHRva2VuOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiY29kZSIpLA0KICAgICAgcHJpbnRsbjogd2luZG93LnByaW50bG4sDQogICAgICBsb2dzOiB3aW5kb3cubG9ncywNCiAgICAgIGlucHV0czogbnVsbCwNCiAgICAgIHNvbHV0aW9uczogWzEsNCw5LDE2XSwNCiAgICAgIHBlZXJTb2NrZXRJZDogbnVsbCwNCiAgICAgIHVwZGF0ZUNvZGVFdmVudEFjdGl2ZTogdHJ1ZQ0KICAgIH07DQogIH0sDQogIGZpbHRlcnM6IHsNCiAgICBzZWNvbmRzVG9TdHJpbmc6IGZ1bmN0aW9uKHZhbHVlKSB7DQogICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcih2YWx1ZSAvIDYwKTsNCiAgICAgIGNvbnN0IHNlY29uZHMgPSB2YWx1ZSAtIG1pbnV0ZXMgKiA2MDsNCg0KICAgICAgcmV0dXJuIGAke21pbnV0ZXN9OiR7KCIwIiArIHNlY29uZHMpLnNsaWNlKC0yKX1gOw0KICAgIH0sDQogIH0sDQogIHNvY2tldHM6IHsNCiAgICBtc2cocGFjaykgew0KICAgICAgZGJnKCJFVkVOVCBtc2ciLHBhY2spOw0KICAgICAgaWYgKHBhY2sudWlkICE9IHRoaXMudWlkICYmIHBhY2sucmlkID09IHRoaXMucmlkKSB7DQogICAgICAgIGNvbnNvbGUubG9nKA0KICAgICAgICAgICJuZXdNc2cgZXZlbnQgdHJpZ2dlcmVkIHdpdGggZGF0YSA8IiArIHRoaXMudG9KU09OKHBhY2spICsgIj4gIg0KICAgICAgICApOw0KICAgICAgICB0aGlzLm5ld01lc3NhZ2UocGFjay5kYXRhLCBmYWxzZSk7DQogICAgICB9DQogICAgfSwNCiAgICByZWZyZXNoQ29kZShwYWNrKSB7DQogICAgICBkYmcoIkVWRU5UIHJlZnJlc2hDb2RlIixwYWNrKTsNCg0KICAgICAgLy8gVG9vIGV4cGVuc2l2ZSBEZWJ1ZyBsb2cNCiAgICAgIC8vY29uc29sZS5sb2coInRleHQgZXZlbnQgdHJpZ2dlcmVkIHdpdGggZGF0YSA8IiArIHRoaXMudG9KU09OKHBhY2spICsgIj4gIik7DQoNCiAgICAgIHRoaXMuJHJlZnMuY21FZGl0b3IuY29kZW1pcnJvci5yZXBsYWNlUmFuZ2UoDQogICAgICAgIHBhY2suY2hhbmdlLnRleHQsDQogICAgICAgIHBhY2suY2hhbmdlLmZyb20sDQogICAgICAgIHBhY2suY2hhbmdlLnRvLA0KICAgICAgICAic2VydmVyIg0KICAgICAgKTsNCiAgICAgDQogICAgfSwNCiAgICBmaW5pc2goKSB7DQogICAgICBkYmcoIkVWRU5UIGZpbmlzaCIpOw0KICAgICAgY29uc29sZS5sb2coIkVWRU5UIGZpbmlzaCB0cmlnZXJlZCEiKTsNCiAgICAgIGZldGNoKA0KICAgICAgICBwcm9jZXNzLmVudi5WVUVfQVBQX1RDX0FQSSArICIvZmluaXNoTWVzc2FnZT9jb2RlPSIgKyBsb2NhbFN0b3JhZ2UuY29kZSwNCiAgICAgICAgew0KICAgICAgICAgIG1ldGhvZDogIkdFVCIsDQogICAgICAgIH0NCiAgICAgICkNCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsNCiAgICAgICAgfSkNCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWU7DQogICAgICAgICAgdGhpcy5maW5pc2hNZXNzYWdlID0gcmVzcG9uc2UuZmluaXNoTWVzc2FnZTsNCiAgICAgICAgICB0aGlzLiRzb2NrZXQuY2xpZW50LmVtaXQoImNsaWVudEZpbmlzaGVkIiwge3Rva2VuOiBsb2NhbFN0b3JhZ2UudG9rZW4sIGNvZGU6IGxvY2FsU3RvcmFnZS5jb2RlfSk7DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgbG9hZFRlc3QocGFjaykgew0KICAgICAgZGJnKCJFVkVOVCBsb2FkVGVzdCIscGFjayk7DQogICAgICB0aGlzLmZpbmlzaGVkID0gZmFsc2U7DQogICAgICB0aGlzLmxvYWRpbmdUZXN0ID0gdHJ1ZTsNCiAgICAgIHRoaXMuc3RhcnRpbmcgPSBmYWxzZTsNCiAgICAgIHRoaXMudGVzdERlc2NyaXB0aW9uID0gcGFjay5kYXRhLnRlc3REZXNjcmlwdGlvbjsNCiAgICAgIHRoaXMucGVlckNoYW5nZSA9IHBhY2suZGF0YS5wZWVyQ2hhbmdlOw0KICAgICAgdGhpcy4kcmVmcy5tZXNzYWdlQ29udGFpbmVyLmlubmVySFRNTCA9ICIiOw0KICAgICAgdGhpcy5jb2RlID0gIiI7DQogICAgICB0aGlzLmNsZWFyUmVzdWx0KCk7DQogICAgfSwNCiAgICBjdXJzb3JBY3Rpdml0eShkYXRhKSB7DQogICAgICBkYmcoIkVWRU5UIGN1cnNvckFjdGl2aXR5IixkYXRhKTsgICAgICANCiAgICAgIHRoaXMuY3Vyc29yTGVmdFBvc2l0aW9uID0gZGF0YS5sZWZ0Ow0KICAgICAgdGhpcy5jdXJzb3JUb3BQb3NpdGlvbiA9IGRhdGEudG9wOw0KICAgICAgdGhpcy51cGRhdGVDdXJzb3JMb2NhdGlvbigpOw0KICAgIH0sDQogICAgbmV3RXhlcmNpc2UocGFjaykgew0KICAgICAgZGJnKCJFVkVOVCBuZXdFeGVyY2lzZSIscGFjayk7ICANCg0KICAgICAgdGhpcy5sb2FkaW5nVGVzdCA9IGZhbHNlOw0KICAgICAgdGhpcy5zdGFydGluZyA9IGZhbHNlOw0KICAgICAgdGhpcy50aW1lUGFzc2VkID0gMDsNCiAgICAgIHRoaXMuaXNFeGVyY2lzZUNvcnJlY3QgPSBudWxsOw0KICAgICAgdGhpcy4kcmVmcy50aW1lQmFyLnN0eWxlLndpZHRoID0gIjEwMCUiOw0KICAgICAgdGhpcy4kcmVmcy50aW1lQmFyLmNsYXNzTGlzdC5yZW1vdmUoImJnLXJlZC01MDAiKTsNCiAgICAgIHRoaXMuJHJlZnMudGltZUJhci5jbGFzc0xpc3QuYWRkKCJiZy1ncmVlbi01MDAiKTsNCiAgICAgIHRoaXMuZXhlcmNpc2VEZXNjcmlwdGlvbiA9IHBhY2suZGF0YS5leGVyY2lzZURlc2NyaXB0aW9uOw0KICAgICAgdGhpcy5leGVyY2lzZVR5cGUgPSBwYWNrLmRhdGEuZXhlcmNpc2VUeXBlOw0KICAgICAgdGhpcy5tYXhUaW1lID0gcGFjay5kYXRhLm1heFRpbWU7DQogICAgICB0aGlzLmlucHV0cyA9IHBhY2suZGF0YS5pbnB1dHM7DQogICAgICB0aGlzLmNsZWFyUmVzdWx0KCk7DQogICAgfSwNCiAgICByZWNvbm5lY3QoKSB7DQogICAgICBkYmcoIkVWRU5UIHJlY29ubmVjdCIpOw0KICAgICAgdGhpcy4kc29ja2V0LmNsaWVudC5lbWl0KCJjbGllbnRSZWNvbm5lY3Rpb24iLCBsb2NhbFN0b3JhZ2UudG9rZW4pOw0KICAgIH0sDQogICAgY291bnREb3duKHBhY2spIHsNCiAgICAgIC8vZGJnKCJFVkVOVCBjb3VudERvd24iLHBhY2spOw0KICAgICAgdGhpcy50aW1lUGFzc2VkID0gdGhpcy5tYXhUaW1lIC0gcGFjay5kYXRhOw0KICAgICAgbGV0IGZhY3RvciA9IDEwMCAvIHRoaXMubWF4VGltZTsNCiAgICAgIGxldCB3aWR0aCA9IHBhcnNlRmxvYXQodGhpcy4kcmVmcy50aW1lQmFyLnN0eWxlLndpZHRoLCAxMCkgLSBmYWN0b3I7DQogICAgICB0aGlzLiRyZWZzLnRpbWVCYXIuc3R5bGUud2lkdGggPSB3aWR0aCArICIlIjsNCiAgICAgIGlmICh3aWR0aCA8IDIwKSB7DQogICAgICAgIHRoaXMuJHJlZnMudGltZUJhci5jbGFzc0xpc3QucmVtb3ZlKCJiZy15ZWxsb3ctNTAwIik7DQogICAgICAgIHRoaXMuJHJlZnMudGltZUJhci5jbGFzc0xpc3QuYWRkKCJiZy1yZWQtNTAwIik7DQogICAgICB9IGVsc2UgaWYgKHdpZHRoIDwgNDApIHsNCiAgICAgICAgdGhpcy4kcmVmcy50aW1lQmFyLmNsYXNzTGlzdC5yZW1vdmUoImJnLWdyZWVuLTUwMCIpOw0KICAgICAgICB0aGlzLiRyZWZzLnRpbWVCYXIuY2xhc3NMaXN0LmFkZCgiYmcteWVsbG93LTUwMCIpOw0KICAgICAgfQ0KICAgIH0sDQogICAgcmVxdWVzdEJ1bGtDb2RlRXZlbnQocGVlclNvY2tldElkKXsNCiAgICAgIGRiZygiRVZFTlQgcmVxdWVzdEJ1bGtDb2RlRXZlbnQiKTsNCiAgICAgIHZhciBjdXJyZW50Q29kZSA9ICB0aGlzLiRyZWZzLmNtRWRpdG9yLmNvZGVtaXJyb3IuZ2V0VmFsdWUoKTsNCiAgICAgIGRiZygiRVZFTlQgcmVxdWVzdEJ1bGtDb2RlRXZlbnQgLSBjb2RlIDogXCIiK2N1cnJlbnRDb2RlKyJcIiIpOw0KICAgICAgaWYodGhpcy5wZWVyU29ja2V0SWQgIT0gcGVlclNvY2tldElkKXsNCiAgICAgICAgdGhpcy5wZWVyU29ja2V0SWQgPSBwZWVyU29ja2V0SWQ7DQogICAgICAgIHRoaXMuJHNvY2tldC5jbGllbnQuZW1pdCgiYnVsa0NvZGUiLCB0aGlzLnBhY2soew0KICAgICAgICAgIHBlZXJTb2NrZXRJZDpwZWVyU29ja2V0SWQsIA0KICAgICAgICAgIGNvZGU6IGN1cnJlbnRDb2RlDQogICAgICAgIH0pKTsNCg0KICAgICAgfWVsc2V7DQogICAgICAgIGRiZygiRVZFTlQgcmVxdWVzdEJ1bGtDb2RlRXZlbnQgLSBJR05PUkVEIGJlY2F1c2UgcGVlclNvY2tldElkIGRpZG4ndCBjaGFuZ2VkIik7DQogICAgICB9DQogICAgfSwNCiAgICBidWxrQ29kZVVwZGF0ZShjb2RlKXsNCiAgICAgIGRiZygiRVZFTlQgYnVsa0NvZGVVcGRhdGUiLGNvZGUpOw0KICAgICAgdmFyIGN1cnJlbnRDb2RlID0gIHRoaXMuJHJlZnMuY21FZGl0b3IuY29kZW1pcnJvci5nZXRWYWx1ZSgpOw0KICAgICAgY29uc29sZS5sb2cNCiAgICAgIGlmKGN1cnJlbnRDb2RlICE9IGNvZGUpew0KICAgICAgICB0aGlzLnVwZGF0ZUNvZGVFdmVudEFjdGl2ZSA9IGZhbHNlOw0KICAgICAgICB0aGlzLiRyZWZzLmNtRWRpdG9yLmNvZGVtaXJyb3Iuc2V0VmFsdWUoY29kZSk7DQogICAgICAgIHRoaXMudXBkYXRlQ29kZUV2ZW50QWN0aXZlID0gdHJ1ZTsNCg0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICBkYmcoImNyZWF0ZWQgLSBpbml0Iik7DQogICAgdmFyIHBhdGhQYXJhbXMgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoIi8iKTsNCiAgICB0aGlzLnJpZCA9IHBhdGhQYXJhbXNbM10gKyAiOiIgKyBwYXRoUGFyYW1zWzJdOw0KDQogICAgdGhpcy51aWQgPSBuZXcgU3RyaW5nKA0KICAgICAgbmV3IERhdGUoKS5nZXRUaW1lKCkgKyBuZXcgRGF0ZSgpLmdldFVUQ01pbGxpc2Vjb25kcygpDQogICAgKS5zdWJzdHIoOCwgMTMpOw0KDQogICAgdGhpcy4kc29ja2V0LmNsaWVudC5lbWl0KCJjbGllbnRSZWNvbm5lY3Rpb24iLCBsb2NhbFN0b3JhZ2UudG9rZW4pOw0KICB9LA0KICB3YXRjaDogew0KICAgIGN1cnNvclRvcFBvc2l0aW9uOiBmdW5jdGlvbih2YWwpIHsNCiAgICAgIGNvbnNvbGUubG9nKHZhbCk7DQogICAgfSwNCiAgICBjdXJzb3JMZWZ0UG9zaXRpb246IGZ1bmN0aW9uKHZhbCkgew0KICAgICAgY29uc29sZS5sb2codmFsKTsNCiAgICB9LA0KICB9LA0KICBtZXRob2RzOiB7DQogICAgc2VuZE1lc3NhZ2UoKSB7DQogICAgICBkYmcoIm1ldGhvZCBzZW5kTWVzc2FnZSAtIGluaXQiLHRoaXMubXlNZXNzYWdlKTsNCiAgICAgIGlmICh0aGlzLmV4ZXJjaXNlVHlwZSA9PSAiUEFJUiIpIHsNCiAgICAgICAgdGhpcy5uZXdNZXNzYWdlKHRoaXMubXlNZXNzYWdlLCB0cnVlKTsNCiAgICAgICAgdGhpcy4kc29ja2V0LmNsaWVudC5lbWl0KCJtc2ciLCB0aGlzLnBhY2sodGhpcy5teU1lc3NhZ2UpKTsNCg0KICAgICAgICB0aGlzLm15TWVzc2FnZSA9ICIiOw0KICAgICAgfQ0KICAgIH0sDQogICAgbmV3TWVzc2FnZShtc2csIG1pbmUpIHsNCiAgICAgIGRiZygibWV0aG9kIG5ld01lc3NhZ2UgLSBpbml0Iixtc2cpOw0KICAgICAgY29uc3QgTWVzc2FnZUNsYXNzID0gVnVlLmV4dGVuZChNZXNzYWdlKTsNCiAgICAgIGxldCBnZW5kZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGFpcmVkVG8iKSA9PT0gJ0ZlbWFsZSc7DQogICAgICBnZW5kZXIgPSB0aGlzLnBlZXJDaGFuZ2UgPyAhZ2VuZGVyIDogZ2VuZGVyOw0KICAgICAgZ2VuZGVyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlciIpKS5ibGluZCA/IG51bGwgOiBnZW5kZXI7DQogICAgICBjb25zdCBtc2dJbnN0YW5jZSA9IG5ldyBNZXNzYWdlQ2xhc3Moew0KICAgICAgICBwcm9wc0RhdGE6IHsNCiAgICAgICAgICBtaW5lOiBtaW5lLA0KICAgICAgICAgIG1lc3NhZ2U6IG1zZywNCiAgICAgICAgICBnaXJsOiBnZW5kZXIsDQogICAgICAgIH0sDQogICAgICB9KTsNCg0KICAgICAgbXNnSW5zdGFuY2UuJG1vdW50KCk7DQogICAgICB0aGlzLiRyZWZzLm1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQobXNnSW5zdGFuY2UuJGVsKTsNCg0KICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuJHJlZnMubWVzc2FnZUNvbnRhaW5lcjsNCiAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AgPSBjb250YWluZXIuc2Nyb2xsSGVpZ2h0Ow0KICAgIH0sDQogICAgdmFsaWRQeXRob24oKSB7DQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnJ5dGhvbkJ1dHRvbiIpLmNsaWNrKCk7DQogICAgICAvL2NvbnNvbGUubG9nKHRoaXMuc29sdXRpb25zKyIgICAgICAgICAgIitkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVzdWx0c1RvVmFsaWRhdGUiKS5pbm5lckhUTUwpOw0KDQogICAgICB2YXIgc29sdXRpb25zQ29tcGlsZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVzdWx0c1RvVmFsaWRhdGUiKS5pbm5lckhUTUw7DQoNCiAgICAgIC8qDQogICAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVzdWx0c1RvVmFsaWRhdGUiKS5pbm5lckhUTUwgPT0gdGhpcy5zb2x1dGlvbnMrIiIpIHsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJlc3VsdHNUb1ZhbGlkYXRlIikuaW5uZXJIVE1MID0gIllvdXIgYW5zd2VyIGlzIGNvcnJlY3QhIg0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVzdWx0c1RvVmFsaWRhdGUiKS5zdHlsZSA9ICJ2aXNpYmlsaXR5OiB2aXNpYmxlOyBiYWNrZ3JvdW5kLWNvbG9yOiBoc2xhKDg5LCA0MyUsIDUxJSwgMC4zKTsgYm9yZGVyLXJhZGl1czogN3B4OyBjb2xvcjogZ3JlZW47IHBhZGRpbmc6IDVweDsgbWFyZ2luLXRvcDogN3B4IjsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXN1bHRzVG9WYWxpZGF0ZSIpLmlubmVySFRNTCA9ICJZb3VyIGFuc3dlciBpcyBub3QgY29ycmVjdCINCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInJlc3VsdHNUb1ZhbGlkYXRlIikuc3R5bGUgPSAidmlzaWJpbGl0eTogdmlzaWJsZTsgYmFja2dyb3VuZC1jb2xvcjogaHNsYSgwLCAxMDAlLCA1MSUsIDAuMyk7IGJvcmRlci1yYWRpdXM6IDdweDsgY29sb3I6IHJlZDsgcGFkZGluZzogNXB4OyBtYXJnaW4tdG9wOiA3cHgiOw0KICAgICAgfQ0KICAgICAgKi8NCiAgICAgIHRyeSB7DQogICAgICAgIHZhciB0b1ZhbGlkYXRlID0gW107DQogICAgICAgIC8vY29uc29sZS5sb2coc29sdXRpb25zQ29tcGlsZWQuc3BsaXQoIiwiKSk7DQogICAgICAgIGZvcih2YXIgcyA9IDA7IHMgPCBzb2x1dGlvbnNDb21waWxlZC5zcGxpdCgiLCIpLmxlbmd0aDsgcysrKSB7DQogICAgICAgICAgdmFyIHQgPSBzb2x1dGlvbnNDb21waWxlZC5zcGxpdCgiLCIpW3NdOw0KICAgICAgICAgIC8vY29uc29sZS5sb2codCk7DQoNCiAgICAgICAgICB2YXIgc29sID0gTnVtYmVyKHQpOyANCiAgICAgICAgICBpZiAoaXNOYU4oc29sKSkgew0KICAgICAgICAgICAgc29sID0gdC50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgdmFyIHNvbDIgPSAoc29sID09ICd0cnVlJyB8fCBzb2wgPT0gJ2ZhbHNlJyk7DQogICAgICAgICAgICBpZiAoc29sMiA9PSBmYWxzZSkgew0KICAgICAgICAgICAgICBzb2wgPSB0Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgc29sID0gdC50b0xvd2VyQ2FzZSgpID09ICd0cnVlJzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgdG9WYWxpZGF0ZS5wdXNoKHNvbCk7DQogICAgICAgIH0NCiAgICAgICAgLy9jb25zb2xlLmxvZyh0b1ZhbGlkYXRlKTsNCiAgICAgICAgdGhpcy52YWxpZCh0b1ZhbGlkYXRlKTsNCiAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgdGhpcy5pc0V4ZXJjaXNlQ29ycmVjdCA9IGZhbHNlOw0KICAgICAgICB0aGlzLmV4Y2VyY2lzZUVycm9yTWVzc2FnZSA9IGU7DQogICAgICAgIGNvbnNvbGUubG9nKCJFUlJPUiBIRVJFOiAiLCBlKTsNCiAgICAgIH0NCiAgICAgIC8qRXhhbXBsZToNCiAgICAgIG91dHB1dHMgPSBbXQ0KICAgICAgZm9yIGkgaW4gaW5wdXRzOg0KICAgICAgICBvdXRwdXRzLmFwcGVuZChpKmkpDQogICAgICAqLw0KICAgIH0sDQogICAgdmFsaWRhdGUoKSB7DQogICAgICBkYmcoIm1ldGhvZCB2YWxpZGF0ZSAtIGluaXQiLHRoaXMuY29kZSk7DQogICAgICB0aGlzLmNsZWFyUmVzdWx0KCk7DQogICAgICB0cnkgew0KICAgICAgICB2YXIgc29sdXRpb25zID0gW107DQoNCiAgICAgICAgdGhpcy5pbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7DQogICAgICAgICAgc29sdXRpb25zLnB1c2goZXZhbCgidmFyIGlucHV0PSIrSlNPTi5zdHJpbmdpZnkoaW5wdXQpKyI7IiArIHRoaXMuY29kZSArICI7IG91dHB1dDsiKSk7DQogICAgICAgIH0pOw0KDQogICAgICAgIGNvbnNvbGUubG9nKCJJbnB1dHM6ICIrSlNPTi5zdHJpbmdpZnkodGhpcy5pbnB1dHMpKTsNCiAgICAgICAgY29uc29sZS5sb2coIk91dHB1dHM6ICIrSlNPTi5zdHJpbmdpZnkoc29sdXRpb25zKSk7DQogICAgICAgIA0KICAgICAgICBjb25zb2xlLmxvZyhzb2x1dGlvbnMpOw0KDQogICAgICAgIHRoaXMudmFsaWQoc29sdXRpb25zKTsNCg0KICAgICAgICAvKmlmIChyZXQpIHsNCiAgICAgICAgICB0aGlzLnZhbGlkKHJldCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy5pc0V4ZXJjaXNlQ29ycmVjdCA9IGZhbHNlOw0KICAgICAgICAgIHRoaXMuZXhjZXJjaXNlRXJyb3JNZXNzYWdlID0gIllvdSBzaG91bGQgcmV0dXJuIHRoZSBzb2x1dGlvbi4iOw0KICAgICAgICB9Ki8NCiAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgdGhpcy5pc0V4ZXJjaXNlQ29ycmVjdCA9IGZhbHNlOw0KICAgICAgICB0aGlzLmV4Y2VyY2lzZUVycm9yTWVzc2FnZSA9IGU7DQogICAgICAgIGNvbnNvbGUubG9nKCJFUlJPUiBIRVJFOiAiLCBlKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGNsZWFyUmVzdWx0KCkgew0KICAgICAgZGJnKCJtZXRob2QgY2xlYXJSZXN1bHQgLSBpbml0Iik7DQogICAgICB0aGlzLmlzRXhlcmNpc2VDb3JyZWN0ID0gbnVsbDsNCiAgICAgIHRoaXMuZXhjZXJjaXNlRXJyb3JNZXNzYWdlICA9ICIiOw0KICAgICAgdGhpcy5yZXR1cm5WYWx1ZSA9ICIiOw0KICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAiIjsNCiAgICAgIHdpbmRvdy5sb2dzID0gW107DQogICAgICB0aGlzLmxvZ3MgPSB3aW5kb3cubG9nczsNCiAgICB9LA0KICAgIHZhbGlkKHYpIHsNCiAgICAgIGRiZygibWV0aG9kIHZhbGlkIC0gaW5pdCIsdik7DQogICAgICBpZiAodGhpcy5leGVyY2lzZVR5cGUgIT0gJ0RFTU8nKSB7DQogICAgICAgIGZldGNoKHByb2Nlc3MuZW52LlZVRV9BUFBfVENfQVBJICsgIi92ZXJpZnkiLCB7DQogICAgICAgICAgbWV0aG9kOiAiUE9TVCIsDQogICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoew0KICAgICAgICAgICAgc29sdXRpb25zOiB2LA0KICAgICAgICAgICAgdXNlcjogbG9jYWxTdG9yYWdlLnRva2VuLA0KICAgICAgICAgICAgc291cmNlOiAiZnVuY3Rpb24gbWFpbihpbnB1dCkgeyAiKw0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5jbUVkaXRvci5jb2RlbWlycm9yLmdldFZhbHVlKCkrDQogICAgICAgICAgICAgICAgICAgICAgICAicmV0dXJuIG91dHB1dDsiKw0KICAgICAgICAgICAgICAgICAgICAifSINCiAgICAgICAgICB9KSwNCiAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLA0KICAgICAgICAgIH0sDQogICAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHsNCiAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKChkYXRhKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuaXNFeGVyY2lzZUNvcnJlY3QgPSBkYXRhLnJlc3VsdDsNCiAgICAgICAgICAgICAgdGhpcy50d2NjID0gZGF0YS50d2NjOw0KICAgICAgICAgICAgICB0aGlzLnJldHVyblZhbHVlID0gdjsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmlzRXhlcmNpc2VDb3JyZWN0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZGVtb0V4ZXJjaXNlKS5zb2x1dGlvbiA9PT0gdjsNCiAgICAgICAgdGhpcy5yZXR1cm5WYWx1ZSA9IHY7DQogICAgICB9DQogICAgfSwNCiAgICBvbkNtQmx1cihjbSkgew0KICAgICAgY29uc29sZS5sb2coImNtIGJsdXIhIiwgY20pOw0KICAgIH0sDQogICAgb25DbUZvY3VzKGNtKSB7DQogICAgICBjb25zb2xlLmxvZygiY20gZm9jdXMhIiwgY20pOw0KICAgIH0sDQogICAgb25DbVJlYWR5KGNtKSB7DQogICAgICBjb25zb2xlLmxvZygiY20gcmVhZHkhIiwgY20pOw0KICAgIH0sDQogICAgZXhpdERlbW8oKSB7DQogICAgICBkYmcoIm1ldGhvZCBleGl0RGVtbyAtIGluaXQiKTsNCiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lSW50ZXJ2YWwpOw0KICAgICAgdGhpcy4kcm91dGVyLmdvKC0xKTsNCiAgICB9LA0KICAgIGxvYWREZW1vRXhlcmNpc2UoKSB7DQogICAgICBkYmcoIm1ldGhvZCBsb2FkRGVtb0V4ZXJjaXNlIC0gaW5pdCIpOw0KICAgICAgY29uc3QgZGVtb0V4ZXJjaXNlID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZGVtb0V4ZXJjaXNlKTsNCiAgICAgIHRoaXMuc3RhcnRpbmcgPSBmYWxzZTsNCiAgICAgIHRoaXMubWF4VGltZSA9IGRlbW9FeGVyY2lzZS50aW1lOw0KICAgICAgdGhpcy5leGVyY2lzZURlc2NyaXB0aW9uID0gZGVtb0V4ZXJjaXNlLmRlc2NyaXB0aW9uOw0KICAgICAgdGhpcy5leGVyY2lzZVR5cGUgPSAiREVNTyINCiAgICAgIHRoaXMudGltZUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgICAgICB0aGlzLnRpbWVQYXNzZWQrKzsNCiAgICAgICAgY29uc29sZS5sb2coIkNvdW50aW5nIGRvd24hIik7DQogICAgICAgIGxldCBmYWN0b3IgPSAxMDAgLyB0aGlzLm1heFRpbWU7DQogICAgICAgIGxldCB3aWR0aCA9IHBhcnNlRmxvYXQodGhpcy4kcmVmcy50aW1lQmFyLnN0eWxlLndpZHRoLCAxMCkgLSBmYWN0b3I7DQogICAgICAgIHRoaXMuJHJlZnMudGltZUJhci5zdHlsZS53aWR0aCA9IHdpZHRoICsgIiUiOw0KICAgICAgICBpZiAod2lkdGggPCAyMCkgew0KICAgICAgICAgIHRoaXMuJHJlZnMudGltZUJhci5jbGFzc0xpc3QucmVtb3ZlKCJiZy15ZWxsb3ctNTAwIik7DQogICAgICAgICAgdGhpcy4kcmVmcy50aW1lQmFyLmNsYXNzTGlzdC5hZGQoImJnLXJlZC01MDAiKTsNCiAgICAgICAgfSBlbHNlIGlmICh3aWR0aCA8IDQwKSB7DQogICAgICAgICAgdGhpcy4kcmVmcy50aW1lQmFyLmNsYXNzTGlzdC5yZW1vdmUoImJnLWdyZWVuLTUwMCIpOw0KICAgICAgICAgIHRoaXMuJHJlZnMudGltZUJhci5jbGFzc0xpc3QuYWRkKCJiZy15ZWxsb3ctNTAwIik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRoaXMudGltZVBhc3NlZCA+IHRoaXMubWF4VGltZSkgew0KICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lSW50ZXJ2YWwpOw0KICAgICAgICB9DQogICAgICB9LDEwMDApOw0KICAgIH0sDQogICAgcGFjayhkYXRhKSB7DQogICAgICBkYmcoIm1ldGhvZCBwYWNrIC0gaW5pdCIsZGF0YSk7DQogICAgICByZXR1cm4gew0KICAgICAgICByaWQ6IHRoaXMucmlkLA0KICAgICAgICB1aWQ6IHRoaXMudWlkLA0KICAgICAgICB0b2tlbjogbG9jYWxTdG9yYWdlLnRva2VuLA0KICAgICAgICBkYXRhOiBkYXRhLA0KICAgICAgfTsNCiAgICB9LA0KICAgIHRvSlNPTihvYmopIHsNCiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmosIG51bGwsIDIpOw0KICAgIH0sDQogICAgZXZhbHVhdGVDb2RlKGNvZGUpIHsNCiAgICAgIGV2YWwoY29kZSk7DQogICAgfSwNCiAgICBoYW5kbGVSZXNpemUoKSB7DQogICAgICBjb25zdCBlbGVtZW50byA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIkNvZGVNaXJyb3Itc2Nyb2xsIilbMF07DQogICAgICBjb25zdCBuZXdMZWZ0ID0NCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvZGVtaXJyb3IiKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0ICsNCiAgICAgICAgdGhpcy5jdXJzb3JMZWZ0UG9zaXRpb24gKw0KICAgICAgICAzMCAtDQogICAgICAgIGVsZW1lbnRvLnNjcm9sbExlZnQ7DQogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGFpckN1cnNvciIpLnN0eWxlLmxlZnQgPSBuZXdMZWZ0ICsgInB4IjsNCiAgICB9LA0KICAgIGhhbmRsZVNjcm9sbCgpIHsNCiAgICAgIGNvbnN0IGNtV2lkdGggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29kZW1pcnJvciIpLm9mZnNldFdpZHRoOw0KICAgICAgY29uc3QgY21IZWlnaHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29kZW1pcnJvciIpLm9mZnNldEhlaWdodCArIDE5Ow0KDQogICAgICBjb25zdCBlbGVtZW50byA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIkNvZGVNaXJyb3Itc2Nyb2xsIilbMF07DQogICAgICBjb25zdCBuZXdUb3AgPQ0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29kZW1pcnJvciIpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCArDQogICAgICAgIHRoaXMuY3Vyc29yVG9wUG9zaXRpb24gKw0KICAgICAgICA1IC0NCiAgICAgICAgZWxlbWVudG8uc2Nyb2xsVG9wOw0KDQogICAgICBjb25zdCBuZXdMZWZ0ID0NCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvZGVtaXJyb3IiKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0ICsNCiAgICAgICAgdGhpcy5jdXJzb3JMZWZ0UG9zaXRpb24gKw0KICAgICAgICAzMCAtDQogICAgICAgIGVsZW1lbnRvLnNjcm9sbExlZnQ7DQogICAgICBpZiAoY21XaWR0aCA+IG5ld0xlZnQpIHsNCiAgICAgICAgdGhpcy4kcmVmcy5wYWlyQ3Vyc29yLnN0eWxlLmxlZnQgPSBuZXdMZWZ0ICsgInB4IjsNCiAgICAgIH0NCiAgICAgIGlmIChjbUhlaWdodCA+IG5ld1RvcCkgew0KICAgICAgICB0aGlzLiRyZWZzLnBhaXJDdXJzb3Iuc3R5bGUudG9wID0gbmV3VG9wICsgInB4IjsNCiAgICAgIH0NCg0KICAgICAgY29uc29sZS5sb2coZWxlbWVudG8uc2Nyb2xsVG9wKTsNCiAgICB9LA0KICAgIGlucHV0UmVhZChpLCBjKSB7DQogICAgICBpZih0aGlzLnVwZGF0ZUNvZGVFdmVudEFjdGl2ZSkNCiAgICAgICAgdGhpcy4kc29ja2V0LmNsaWVudC5lbWl0KCJ1cGRhdGVDb2RlIiwgYyk7DQogICAgfSwNCiAgICBjdXJzb3JBY3Rpdml0eShkb2MpIHsNCiAgICAgIGRiZygibWV0aG9kIGN1cnNvckFjdGl2aXR5IC0gaW5pdCIpOw0KICAgICAgdGhpcy4kc29ja2V0LmNsaWVudC5lbWl0KA0KICAgICAgICAiY3Vyc29yQWN0aXZpdHkiLA0KICAgICAgICBkb2MuY3Vyc29yQ29vcmRzKGZhbHNlLCAicmVsYXRpdmUiKQ0KICAgICAgKTsNCiAgICB9LA0KICAgIG9uQ21Db2RlQ2hhbmdlKGUsIGMpIHsNCiAgICAgIGNvbnN0IGNoYW5nZU9iaiA9IHsNCiAgICAgICAgYXV0aG9yOiB0aGlzLiRzb2NrZXQuY2xpZW50LmlkLA0KICAgICAgICBjaGFuZ2U6IGMsDQogICAgICB9Ow0KICAgICAgaWYgKGMub3JpZ2luICE9ICJzZXJ2ZXIiKSB7DQogICAgICAgIGlmKHRoaXMudXBkYXRlQ29kZUV2ZW50QWN0aXZlKQ0KICAgICAgICAgIHRoaXMuJHNvY2tldC5jbGllbnQuZW1pdCgidXBkYXRlQ29kZSIsIHRoaXMucGFjayhjaGFuZ2VPYmopKTsNCiAgICAgIH0NCiAgICAgIHRoaXMuZmlyc3RMb2FkID0gZmFsc2U7DQogICAgfSwNCiAgICB1cGRhdGVDdXJzb3JMb2NhdGlvbigpIHsNCiAgICAgIGNvbnN0IGNtV2lkdGggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29kZW1pcnJvciIpLm9mZnNldFdpZHRoOw0KICAgICAgY29uc3QgY21IZWlnaHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29kZW1pcnJvciIpLm9mZnNldEhlaWdodDsNCiAgICAgIGNvbnNvbGUubG9nKGNtSGVpZ2h0KTsNCg0KICAgICAgY29uc3QgZWxlbWVudG8gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJDb2RlTWlycm9yLXNjcm9sbCIpWzBdOw0KDQogICAgICBjb25zdCB0b3AgPQ0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29kZW1pcnJvciIpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCArDQogICAgICAgIHRoaXMuY3Vyc29yVG9wUG9zaXRpb24gKw0KICAgICAgICA1IC0NCiAgICAgICAgZWxlbWVudG8uc2Nyb2xsVG9wOw0KICAgICAgY29uc3QgbGVmdCA9DQogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb2RlbWlycm9yIikuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCArDQogICAgICAgIHRoaXMuY3Vyc29yTGVmdFBvc2l0aW9uICsNCiAgICAgICAgMzAgLQ0KICAgICAgICBlbGVtZW50by5zY3JvbGxMZWZ0Ow0KICAgICAgY29uc29sZS5sb2codG9wKTsNCiAgICAgIGNvbnNvbGUubG9nKGNtSGVpZ2h0KTsNCiAgICAgIGlmIChjbVdpZHRoID4gbGVmdCkgew0KICAgICAgICB0aGlzLiRyZWZzLnBhaXJDdXJzb3Iuc3R5bGUubGVmdCA9IGxlZnQgKyAicHgiOw0KICAgICAgfQ0KICAgICAgaWYgKGNtSGVpZ2h0ID4gdG9wKSB7DQogICAgICAgIHRoaXMuJHJlZnMucGFpckN1cnNvci5zdHlsZS50b3AgPSB0b3AgKyAicHgiOw0KICAgICAgfQ0KICAgIH0sDQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgY21FZGl0b3IoKSB7DQogICAgICByZXR1cm4gdGhpcy4kcmVmcy5jbUVkaXRvci5jb2RlbWlycm9yOw0KICAgIH0sDQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgZGJnKCJtb3VudGVkIC0gaW5pdCIpOw0KDQogICAgdGhpcy4kcmVmcy5jbUVkaXRvci5jb2RlbWlycm9yLm9uKCJjaGFuZ2UiLCB0aGlzLm9uQ21Db2RlQ2hhbmdlKTsNCiAgICB0aGlzLiRyZWZzLmNtRWRpdG9yLmNvZGVtaXJyb3Iub24oImN1cnNvckFjdGl2aXR5IiwgdGhpcy5jdXJzb3JBY3Rpdml0eSk7DQogICAgY29uc3QgZWxlbWVudG8gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJDb2RlTWlycm9yLXNjcm9sbCIpWzBdOw0KICAgIGVsZW1lbnRvLmFkZEV2ZW50TGlzdGVuZXIoInNjcm9sbCIsIHRoaXMuaGFuZGxlU2Nyb2xsKTsNCg0KICAgIC8vIEN1cnNvciBmdW5jdGlvbmFsaXkgZGlzYWJsZWQNCiAgICAvKmxldCB0b2dnbGUgPSB0cnVlOw0KICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkgew0KICAgICAgaWYgKHRvZ2dsZSkgew0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGFpckN1cnNvciIpLmNsYXNzTGlzdC5hZGQoImludmlzaWJsZSIpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBhaXJDdXJzb3IiKS5jbGFzc0xpc3QucmVtb3ZlKCJpbnZpc2libGUiKTsNCiAgICAgIH0NCiAgICAgIHRvZ2dsZSA9ICF0b2dnbGU7DQogICAgfSwgNzUwKTsqLw0KDQogICAgLy8gRGlzYWJsZSBjdHJsK3Mgc2hvcnRrZXkgaW4gV2luZG93cyBvciBMaW51eA0KICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGV2ZW50ID0+IHsNCiAgICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSkgew0KICAgICAgc3dpdGNoIChTdHJpbmcuZnJvbUNoYXJDb2RlKGV2ZW50LndoaWNoKS50b0xvd2VyQ2FzZSgpKSB7DQogICAgICAgIGNhc2UgInMiOg0KICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgYnJlYWs7DQogICAgICB9DQogICAgIH0NCiAgICB9KTsNCg0KICAgIHRoaXMuJHJlZnMudGltZUJhci5zdHlsZS53aWR0aCA9IGAkeygodGhpcy5tYXhUaW1lIC0gdGhpcy50aW1lUGFzc2VkKSAvDQogICAgICB0aGlzLm1heFRpbWUpICoNCiAgICAgIDEwMH0lYDsNCg0KICAgIGlmIChsb2NhbFN0b3JhZ2UuZGVtb0V4ZXJjaXNlKSB7DQogICAgICB0aGlzLmxvYWREZW1vRXhlcmNpc2UoKTsNCiAgICB9DQogIH0sDQogIGJlZm9yZURlc3Ryb3koKSB7DQogICAgZGJnKCJiZWZvcmVEZXN0cm95IC0gaW5pdCIpOw0KICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJyZXNpemUiLCB0aGlzLmhhbmRsZVNjcm9sbCk7DQogICAgY29uc3QgZWxlbWVudG8gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJDb2RlTWlycm9yLXNjcm9sbCIpWzBdOw0KICAgIGlmIChlbGVtZW50bykgew0KICAgICAgZWxlbWVudG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcigic2Nyb2xsIiwgdGhpcy5oYW5kbGVTY3JvbGwpOw0KICAgIH0NCiAgfSwNCn07DQo="},{"version":3,"sources":["Playground.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8LA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Playground.vue","sourceRoot":"src/pages","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"container h-screen mx-auto\" v-if=\"!finished\">\r\n      <div class=\"shadow w-full bg-grey-light h-3\">\r\n        <div\r\n          ref=\"timeBar\"\r\n          class=\"bg-green-500 text-xs leading-none py-1 text-center text-white h-3\"\r\n          style=\"transition: 1s; width: 100%;\"\r\n        ></div>\r\n      </div>\r\n      <div v-if=\"exerciseType == 'DEMO'\" >\r\n          <div class=\"m-3 p-1 bg-yellow-200 border border-yellow-700 rounded-sm\">\r\n            <a class=\"ml-2 text-sm text-yellow-900 underline cursor-pointer\" @click=\"exitDemo()\">Click here to end the demo.</a>\r\n          </div>\r\n      </div>\r\n      <div class=\"flex h-full flex-wrap\">\r\n        <div class=\"w-2/3 p-2\">\r\n          <div>{{ (maxTime - timePassed) | secondsToString }}</div>\r\n          <div v-html=\"exerciseDescription\"></div>\r\n          <div style=\"height: 70vh;\" @keyup.ctrl.83=\"validate\" >\r\n            <div\r\n              ref=\"pairCursor\"\r\n              id=\"pairCursor\"\r\n              class=\"absolute bg-yellow-500 hidden\"\r\n            ></div>\r\n            <br/>\r\n            <pre><p class=\"text-purple-800 inline\">function</p> main(input) {</pre>\r\n            <codemirror\r\n              ref=\"cmEditor\"\r\n              v-model=\"code\"\r\n              id=\"codemirror\"\r\n              :options=\"cmOption\"\r\n              :events=\"['inputRead', 'change']\"\r\n            ></codemirror>\r\n        <pre style=\"visibility: hidden;\" id=\"codePre\">{{code}}</pre>\r\n        <pre style=\"visibility: hidden;\" id=\"listInputs\">{{inputs}}</pre>\r\n            <pre>     <p class=\"text-pink-700 inline\">return</p> output;</pre>\r\n            <pre>}</pre>\r\n            <br/>\r\n          </div>\r\n          <div\r\n            v-if=\"isExerciseCorrect\"\r\n            class=\"flex bg-green-200 p-3 mt-5 rounded-md border text-gray-800\"\r\n          >\r\n            <p class=\"mt-1 text-black-900\">\r\n              You got it right! Value returned: {{ returnValue }} <br/> Quality Score: <strong>{{ twcc }}</strong> (the lower the better)\r\n            </p>\r\n            <div class=\"flex-grow text-right\">\r\n              <button @click=\"clearResult\">\r\n                <img\r\n                  class=\"w-4\"\r\n                  src=\"https://img.icons8.com/small/32/000000/close-window.png\"\r\n                />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div\r\n            v-if=\"isExerciseCorrect === false\"\r\n            class=\"bg-red-200 p-3 rounded-md border text-gray-800 relative\"\r\n          >\r\n            <p>Sorry, this is not the right solution. Try again!</p>\r\n            <p class=\"mt-1 text-red-900\">\r\n              Value returned: {{ excerciseErrorMessage || returnValue }}\r\n            </p>\r\n            <div class=\"absolute top-0 right-0 mt-1 mr-1\">\r\n              <button @click=\"clearResult\">\r\n                <img\r\n                  class=\"w-4\"\r\n                  src=\"https://img.icons8.com/small/32/000000/close-window.png\"\r\n                />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div v-if=\"returnValue\" class=\"p-3 bg-black text-white mt-2 rounded-md\">\r\n            <p>Your console log:</p>\r\n            <p class=\"mt-1 text-black-900\" v-for=\"log in logs\" :key=\"log\">\r\n              <pre>$> {{ log }} </pre>\r\n            </p>\r\n          </div>\r\n        <pre style=\"visibility: hidden;\" id=\"resultsToValidate\"></pre>\r\n\r\n          <div class=\"mt-2\" style=\"bottom: 5px;\">\r\n            <!--<button\r\n                class=\"bg-yellow-800 hover:bg-yellow-700 p-3 text-white shadow-md focus:outline-none focus:shadow-outline m-1\"\r\n                onClick=\"toggleControlMode();\"\r\n              >\r\n                Give control\r\n              </button>-->\r\n            <button\r\n              class=\"bg-teal-600 hover:bg-teal-500 p-3 text-white shadow-md focus:outline-none focus:shadow-outline m-1\"\r\n              @click=\"validate()\"\r\n            >\r\n              Validate in js\r\n            </button>\r\n\r\n          <button\r\n            class=\"bg-orange-600 hover:bg-orange-500 p-3 text-white shadow-md focus:outline-none focus:shadow-outline m-1\"\r\n            @click=\"validPython()\"\r\n          >\r\n            Validate in python\r\n          </button>\r\n          </div>\r\n          <div id=\"return\"></div>\r\n          <div id=\"result\"></div>\r\n        </div>\r\n        <div class=\"w-1/3 h-full p-2\">\r\n          <div class=\"bg-gray-100 h-full p-2 flex flex-col-reverse\">\r\n            <div class=\"order-4 h-2/6\">\r\n              <img class=\"w-12 inline\" src=\"@/assets/chat.png\" />\r\n              <p class=\"text-2xl inline pl-3 mt-2 text-teal-900\">\r\n                Chat\r\n              </p>\r\n              <p class=\"p-3\">This is a place to chat with your peer</p>\r\n            </div>\r\n            <div\r\n              class=\"flex-grow p-3 order-2 h-3/6 overflow-auto w-full\"\r\n              ref=\"messageContainer\"\r\n            ></div>\r\n            <div class=\"p-3 order-1 h-1/6\">\r\n              <textarea\r\n                :disabled=\"exerciseType != 'PAIR'\"\r\n                v-model=\"myMessage\"\r\n                class=\"border resize-none w-full text-sm p-2\"\r\n                placeholder=\"Write message here and press ENTER\"\r\n                v-on:keyup.enter=\"sendMessage()\"\r\n              >\r\n              </textarea>\r\n              <p class=\"text-xs text-gray-600\">\r\n                Press ENTER to send Message\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div\r\n      v-if=\"finished\"\r\n      class=\"container mx-auto h-screen flex justify-center items-center\"\r\n    >\r\n      <div class=\"max-w-lg\">\r\n        <h1 class=\"mb-6 text-center font-hairline text-3xl\">\r\n          Session is over\r\n        </h1>\r\n        <div\r\n          class=\"bg-teal-100 border-teal-600 p-8 border-t-8 bg-white mb-6 rounded-md shadow-lg m-5\"\r\n        >\r\n          <h1 class=\"font-bold text-2xl mb-4\">Congratulations!</h1>\r\n          <p class=\"font-medium\" v-html=\"finishMessage\">\r\n          </p>\r\n        </div>\r\n        <div class=\"text-center\">\r\n          <p class=\"text-grey-dark text-sm inline\">\r\n            Universidad de Sevilla\r\n          </p>\r\n          <p class=\"text-grey-dark text-sm inline font-hairline mr-1 ml-1\">|</p>\r\n          <p class=\"text-grey-dark text-sm inline\">\r\n            University of California, Berkeley\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div\r\n      v-if=\"starting\"\r\n      class=\"fixed h-full w-full top-0 z-50 flex justify-center items-center\"\r\n      style=\"backdrop-filter: blur(2px);\"\r\n    >\r\n      <img src=\"@/assets/tc_color.png\" class=\"w-48\" />\r\n    </div>\r\n    <div\r\n      v-if=\"loadingTest\"\r\n      class=\"fixed h-full w-full top-0 z-50 flex justify-center items-center\"\r\n      style=\"backdrop-filter: blur(2px);\"\r\n    >\r\n      <div\r\n        class=\"border-teal-600 p-8 border-t-8 bg-white mb-6 rounded-md shadow-lg m-5 w-2/3\"\r\n      >\r\n        <h1 class=\"font-bold text-2xl mb-4\">A new test begins!</h1>\r\n        <h2 class=\"font-bold text-xl text-gray-600\">\r\n          {{ (maxTime - timePassed) | secondsToString }}\r\n        </h2>\r\n        <p class=\"font-medium\" v-html=\"testDescription\"></p>\r\n        <p class=\"font-normal mt-1\">Your ID: {{ token }}</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from \"vue\";\r\nimport Message from \"../components/Message\";\r\nimport { codemirror } from \"vue-codemirror\";\r\nimport \"codemirror/mode/javascript/javascript.js\";\r\nimport \"codemirror/lib/codemirror.css\";\r\n\r\nfunction dbg(msg, obj, fields) {\r\n  \r\n  function replacer(key, value) {\r\n    const originalObject = this[key];\r\n    if(originalObject instanceof Map) {\r\n      return {\r\n        dataType: 'Map',\r\n        value: Array.from(originalObject.entries()), \r\n      };\r\n    } else {\r\n      return value;\r\n    }\r\n  }\r\n\r\n  if(obj){\r\n    if(fields && Array.isArray(fields)){\r\n      var logObj = {};\r\n      for (const field in obj) {\r\n        if(fields.includes(field))\r\n          logObj[field] = obj[field];\r\n      }       \r\n      console.log(\"DEBUG - \"+msg+\" <\"+JSON.stringify(logObj,replacer).slice(0, -1)+\",...}>\"); \r\n    }else{\r\n      console.log(\"DEBUG - \"+msg+\" <\"+JSON.stringify(obj,replacer)+\">\");\r\n    }\r\n\r\n  } else{\r\n      console.log(\"DEBUG - \"+msg);\r\n  }\r\n\r\n}\r\n\r\nexport default {\r\n  components: {\r\n    codemirror,\r\n  },\r\n  data() {\r\n    return {\r\n      code: ``,\r\n      cmOption: {\r\n        tabSize: 4,\r\n        styleActiveLine: true,\r\n        lineNumbers: true,\r\n        mode: \"text/javascript\",\r\n      },\r\n      firstLoad: true,\r\n      awaiting: null,\r\n      cursorLeftPosition: 0,\r\n      cursorTopPosition: 0,\r\n      myMessage: \"\",\r\n      uid: \"\",\r\n      rid: \"\",\r\n      lastReceived: \"\",\r\n      exerciseDescription: \"Please, wait until the exercise loads...\",\r\n      exerciseLoaded: false,\r\n      exerciseType: \"PAIR\",\r\n      testDescription: \"\",\r\n      finished: false,\r\n      starting: true,\r\n      loadingTest: false,\r\n      peerChange: false,\r\n      timeInterval: null,\r\n      maxTime: 0,\r\n      timePassed: 0,\r\n      isExerciseCorrect: null,\r\n      twcc:null,\r\n      excerciseErrorMessage: \"\",\r\n      returnValue: \"\",\r\n      token: localStorage.getItem(\"code\"),\r\n      println: window.println,\r\n      logs: window.logs,\r\n      inputs: null,\r\n      solutions: [1,4,9,16],\r\n      peerSocketId: null,\r\n      updateCodeEventActive: true\r\n    };\r\n  },\r\n  filters: {\r\n    secondsToString: function(value) {\r\n      const minutes = Math.floor(value / 60);\r\n      const seconds = value - minutes * 60;\r\n\r\n      return `${minutes}:${(\"0\" + seconds).slice(-2)}`;\r\n    },\r\n  },\r\n  sockets: {\r\n    msg(pack) {\r\n      dbg(\"EVENT msg\",pack);\r\n      if (pack.uid != this.uid && pack.rid == this.rid) {\r\n        console.log(\r\n          \"newMsg event triggered with data <\" + this.toJSON(pack) + \"> \"\r\n        );\r\n        this.newMessage(pack.data, false);\r\n      }\r\n    },\r\n    refreshCode(pack) {\r\n      dbg(\"EVENT refreshCode\",pack);\r\n\r\n      // Too expensive Debug log\r\n      //console.log(\"text event triggered with data <\" + this.toJSON(pack) + \"> \");\r\n\r\n      this.$refs.cmEditor.codemirror.replaceRange(\r\n        pack.change.text,\r\n        pack.change.from,\r\n        pack.change.to,\r\n        \"server\"\r\n      );\r\n     \r\n    },\r\n    finish() {\r\n      dbg(\"EVENT finish\");\r\n      console.log(\"EVENT finish trigered!\");\r\n      fetch(\r\n        process.env.VUE_APP_TC_API + \"/finishMessage?code=\" + localStorage.code,\r\n        {\r\n          method: \"GET\",\r\n        }\r\n      )\r\n        .then((response) => {\r\n          return response.json();\r\n        })\r\n        .then((response) => {\r\n          this.finished = true;\r\n          this.finishMessage = response.finishMessage;\r\n          this.$socket.client.emit(\"clientFinished\", {token: localStorage.token, code: localStorage.code});\r\n        });\r\n    },\r\n    loadTest(pack) {\r\n      dbg(\"EVENT loadTest\",pack);\r\n      this.finished = false;\r\n      this.loadingTest = true;\r\n      this.starting = false;\r\n      this.testDescription = pack.data.testDescription;\r\n      this.peerChange = pack.data.peerChange;\r\n      this.$refs.messageContainer.innerHTML = \"\";\r\n      this.code = \"\";\r\n      this.clearResult();\r\n    },\r\n    cursorActivity(data) {\r\n      dbg(\"EVENT cursorActivity\",data);      \r\n      this.cursorLeftPosition = data.left;\r\n      this.cursorTopPosition = data.top;\r\n      this.updateCursorLocation();\r\n    },\r\n    newExercise(pack) {\r\n      dbg(\"EVENT newExercise\",pack);  \r\n\r\n      this.loadingTest = false;\r\n      this.starting = false;\r\n      this.timePassed = 0;\r\n      this.isExerciseCorrect = null;\r\n      this.$refs.timeBar.style.width = \"100%\";\r\n      this.$refs.timeBar.classList.remove(\"bg-red-500\");\r\n      this.$refs.timeBar.classList.add(\"bg-green-500\");\r\n      this.exerciseDescription = pack.data.exerciseDescription;\r\n      this.exerciseType = pack.data.exerciseType;\r\n      this.maxTime = pack.data.maxTime;\r\n      this.inputs = pack.data.inputs;\r\n      this.clearResult();\r\n    },\r\n    reconnect() {\r\n      dbg(\"EVENT reconnect\");\r\n      this.$socket.client.emit(\"clientReconnection\", localStorage.token);\r\n    },\r\n    countDown(pack) {\r\n      //dbg(\"EVENT countDown\",pack);\r\n      this.timePassed = this.maxTime - pack.data;\r\n      let factor = 100 / this.maxTime;\r\n      let width = parseFloat(this.$refs.timeBar.style.width, 10) - factor;\r\n      this.$refs.timeBar.style.width = width + \"%\";\r\n      if (width < 20) {\r\n        this.$refs.timeBar.classList.remove(\"bg-yellow-500\");\r\n        this.$refs.timeBar.classList.add(\"bg-red-500\");\r\n      } else if (width < 40) {\r\n        this.$refs.timeBar.classList.remove(\"bg-green-500\");\r\n        this.$refs.timeBar.classList.add(\"bg-yellow-500\");\r\n      }\r\n    },\r\n    requestBulkCodeEvent(peerSocketId){\r\n      dbg(\"EVENT requestBulkCodeEvent\");\r\n      var currentCode =  this.$refs.cmEditor.codemirror.getValue();\r\n      dbg(\"EVENT requestBulkCodeEvent - code : \\\"\"+currentCode+\"\\\"\");\r\n      if(this.peerSocketId != peerSocketId){\r\n        this.peerSocketId = peerSocketId;\r\n        this.$socket.client.emit(\"bulkCode\", this.pack({\r\n          peerSocketId:peerSocketId, \r\n          code: currentCode\r\n        }));\r\n\r\n      }else{\r\n        dbg(\"EVENT requestBulkCodeEvent - IGNORED because peerSocketId didn't changed\");\r\n      }\r\n    },\r\n    bulkCodeUpdate(code){\r\n      dbg(\"EVENT bulkCodeUpdate\",code);\r\n      var currentCode =  this.$refs.cmEditor.codemirror.getValue();\r\n      console.log\r\n      if(currentCode != code){\r\n        this.updateCodeEventActive = false;\r\n        this.$refs.cmEditor.codemirror.setValue(code);\r\n        this.updateCodeEventActive = true;\r\n\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    dbg(\"created - init\");\r\n    var pathParams = window.location.pathname.split(\"/\");\r\n    this.rid = pathParams[3] + \":\" + pathParams[2];\r\n\r\n    this.uid = new String(\r\n      new Date().getTime() + new Date().getUTCMilliseconds()\r\n    ).substr(8, 13);\r\n\r\n    this.$socket.client.emit(\"clientReconnection\", localStorage.token);\r\n  },\r\n  watch: {\r\n    cursorTopPosition: function(val) {\r\n      console.log(val);\r\n    },\r\n    cursorLeftPosition: function(val) {\r\n      console.log(val);\r\n    },\r\n  },\r\n  methods: {\r\n    sendMessage() {\r\n      dbg(\"method sendMessage - init\",this.myMessage);\r\n      if (this.exerciseType == \"PAIR\") {\r\n        this.newMessage(this.myMessage, true);\r\n        this.$socket.client.emit(\"msg\", this.pack(this.myMessage));\r\n\r\n        this.myMessage = \"\";\r\n      }\r\n    },\r\n    newMessage(msg, mine) {\r\n      dbg(\"method newMessage - init\",msg);\r\n      const MessageClass = Vue.extend(Message);\r\n      let gender = localStorage.getItem(\"pairedTo\") === 'Female';\r\n      gender = this.peerChange ? !gender : gender;\r\n      gender = JSON.parse(localStorage.getItem(\"user\")).blind ? null : gender;\r\n      const msgInstance = new MessageClass({\r\n        propsData: {\r\n          mine: mine,\r\n          message: msg,\r\n          girl: gender,\r\n        },\r\n      });\r\n\r\n      msgInstance.$mount();\r\n      this.$refs.messageContainer.appendChild(msgInstance.$el);\r\n\r\n      var container = this.$refs.messageContainer;\r\n      container.scrollTop = container.scrollHeight;\r\n    },\r\n    validPython() {\r\n      document.getElementById(\"brythonButton\").click();\r\n      //console.log(this.solutions+\"          \"+document.getElementById(\"resultsToValidate\").innerHTML);\r\n\r\n      var solutionsCompiled = document.getElementById(\"resultsToValidate\").innerHTML;\r\n\r\n      /*\r\n      if(document.getElementById(\"resultsToValidate\").innerHTML == this.solutions+\"\") {\r\n        document.getElementById(\"resultsToValidate\").innerHTML = \"Your answer is correct!\"\r\n        document.getElementById(\"resultsToValidate\").style = \"visibility: visible; background-color: hsla(89, 43%, 51%, 0.3); border-radius: 7px; color: green; padding: 5px; margin-top: 7px\";\r\n      } else {\r\n        document.getElementById(\"resultsToValidate\").innerHTML = \"Your answer is not correct\"\r\n        document.getElementById(\"resultsToValidate\").style = \"visibility: visible; background-color: hsla(0, 100%, 51%, 0.3); border-radius: 7px; color: red; padding: 5px; margin-top: 7px\";\r\n      }\r\n      */\r\n      try {\r\n        var toValidate = [];\r\n        //console.log(solutionsCompiled.split(\",\"));\r\n        for(var s = 0; s < solutionsCompiled.split(\",\").length; s++) {\r\n          var t = solutionsCompiled.split(\",\")[s];\r\n          //console.log(t);\r\n\r\n          var sol = Number(t); \r\n          if (isNaN(sol)) {\r\n            sol = t.toLowerCase();\r\n            var sol2 = (sol == 'true' || sol == 'false');\r\n            if (sol2 == false) {\r\n              sol = t;\r\n            } else {\r\n              sol = t.toLowerCase() == 'true';\r\n            }\r\n          }\r\n          toValidate.push(sol);\r\n        }\r\n        //console.log(toValidate);\r\n        this.valid(toValidate);\r\n      } catch (e) {\r\n        this.isExerciseCorrect = false;\r\n        this.excerciseErrorMessage = e;\r\n        console.log(\"ERROR HERE: \", e);\r\n      }\r\n      /*Example:\r\n      outputs = []\r\n      for i in inputs:\r\n        outputs.append(i*i)\r\n      */\r\n    },\r\n    validate() {\r\n      dbg(\"method validate - init\",this.code);\r\n      this.clearResult();\r\n      try {\r\n        var solutions = [];\r\n\r\n        this.inputs.forEach(input => {\r\n          solutions.push(eval(\"var input=\"+JSON.stringify(input)+\";\" + this.code + \"; output;\"));\r\n        });\r\n\r\n        console.log(\"Inputs: \"+JSON.stringify(this.inputs));\r\n        console.log(\"Outputs: \"+JSON.stringify(solutions));\r\n        \r\n        console.log(solutions);\r\n\r\n        this.valid(solutions);\r\n\r\n        /*if (ret) {\r\n          this.valid(ret);\r\n        } else {\r\n          this.isExerciseCorrect = false;\r\n          this.excerciseErrorMessage = \"You should return the solution.\";\r\n        }*/\r\n      } catch (e) {\r\n        this.isExerciseCorrect = false;\r\n        this.excerciseErrorMessage = e;\r\n        console.log(\"ERROR HERE: \", e);\r\n      }\r\n    },\r\n    clearResult() {\r\n      dbg(\"method clearResult - init\");\r\n      this.isExerciseCorrect = null;\r\n      this.excerciseErrorMessage  = \"\";\r\n      this.returnValue = \"\";\r\n      this.errorMessage = \"\";\r\n      window.logs = [];\r\n      this.logs = window.logs;\r\n    },\r\n    valid(v) {\r\n      dbg(\"method valid - init\",v);\r\n      if (this.exerciseType != 'DEMO') {\r\n        fetch(process.env.VUE_APP_TC_API + \"/verify\", {\r\n          method: \"POST\",\r\n          body: JSON.stringify({\r\n            solutions: v,\r\n            user: localStorage.token,\r\n            source: \"function main(input) { \"+\r\n                        this.$refs.cmEditor.codemirror.getValue()+\r\n                        \"return output;\"+\r\n                    \"}\"\r\n          }),\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n        }).then((response) => {\r\n          if (response.status == 200) {\r\n            response.json().then((data) => {\r\n              this.isExerciseCorrect = data.result;\r\n              this.twcc = data.twcc;\r\n              this.returnValue = v;\r\n            });\r\n          }\r\n        });\r\n      } else {\r\n        this.isExerciseCorrect = JSON.parse(localStorage.demoExercise).solution === v;\r\n        this.returnValue = v;\r\n      }\r\n    },\r\n    onCmBlur(cm) {\r\n      console.log(\"cm blur!\", cm);\r\n    },\r\n    onCmFocus(cm) {\r\n      console.log(\"cm focus!\", cm);\r\n    },\r\n    onCmReady(cm) {\r\n      console.log(\"cm ready!\", cm);\r\n    },\r\n    exitDemo() {\r\n      dbg(\"method exitDemo - init\");\r\n      clearInterval(this.timeInterval);\r\n      this.$router.go(-1);\r\n    },\r\n    loadDemoExercise() {\r\n      dbg(\"method loadDemoExercise - init\");\r\n      const demoExercise = JSON.parse(localStorage.demoExercise);\r\n      this.starting = false;\r\n      this.maxTime = demoExercise.time;\r\n      this.exerciseDescription = demoExercise.description;\r\n      this.exerciseType = \"DEMO\"\r\n      this.timeInterval = setInterval(() => {\r\n        this.timePassed++;\r\n        console.log(\"Counting down!\");\r\n        let factor = 100 / this.maxTime;\r\n        let width = parseFloat(this.$refs.timeBar.style.width, 10) - factor;\r\n        this.$refs.timeBar.style.width = width + \"%\";\r\n        if (width < 20) {\r\n          this.$refs.timeBar.classList.remove(\"bg-yellow-500\");\r\n          this.$refs.timeBar.classList.add(\"bg-red-500\");\r\n        } else if (width < 40) {\r\n          this.$refs.timeBar.classList.remove(\"bg-green-500\");\r\n          this.$refs.timeBar.classList.add(\"bg-yellow-500\");\r\n        }\r\n        if (this.timePassed > this.maxTime) {\r\n          clearInterval(this.timeInterval);\r\n        }\r\n      },1000);\r\n    },\r\n    pack(data) {\r\n      dbg(\"method pack - init\",data);\r\n      return {\r\n        rid: this.rid,\r\n        uid: this.uid,\r\n        token: localStorage.token,\r\n        data: data,\r\n      };\r\n    },\r\n    toJSON(obj) {\r\n      return JSON.stringify(obj, null, 2);\r\n    },\r\n    evaluateCode(code) {\r\n      eval(code);\r\n    },\r\n    handleResize() {\r\n      const elemento = document.getElementsByClassName(\"CodeMirror-scroll\")[0];\r\n      const newLeft =\r\n        document.getElementById(\"codemirror\").getBoundingClientRect().left +\r\n        this.cursorLeftPosition +\r\n        30 -\r\n        elemento.scrollLeft;\r\n      document.getElementById(\"pairCursor\").style.left = newLeft + \"px\";\r\n    },\r\n    handleScroll() {\r\n      const cmWidth = document.getElementById(\"codemirror\").offsetWidth;\r\n      const cmHeight = document.getElementById(\"codemirror\").offsetHeight + 19;\r\n\r\n      const elemento = document.getElementsByClassName(\"CodeMirror-scroll\")[0];\r\n      const newTop =\r\n        document.getElementById(\"codemirror\").getBoundingClientRect().top +\r\n        this.cursorTopPosition +\r\n        5 -\r\n        elemento.scrollTop;\r\n\r\n      const newLeft =\r\n        document.getElementById(\"codemirror\").getBoundingClientRect().left +\r\n        this.cursorLeftPosition +\r\n        30 -\r\n        elemento.scrollLeft;\r\n      if (cmWidth > newLeft) {\r\n        this.$refs.pairCursor.style.left = newLeft + \"px\";\r\n      }\r\n      if (cmHeight > newTop) {\r\n        this.$refs.pairCursor.style.top = newTop + \"px\";\r\n      }\r\n\r\n      console.log(elemento.scrollTop);\r\n    },\r\n    inputRead(i, c) {\r\n      if(this.updateCodeEventActive)\r\n        this.$socket.client.emit(\"updateCode\", c);\r\n    },\r\n    cursorActivity(doc) {\r\n      dbg(\"method cursorActivity - init\");\r\n      this.$socket.client.emit(\r\n        \"cursorActivity\",\r\n        doc.cursorCoords(false, \"relative\")\r\n      );\r\n    },\r\n    onCmCodeChange(e, c) {\r\n      const changeObj = {\r\n        author: this.$socket.client.id,\r\n        change: c,\r\n      };\r\n      if (c.origin != \"server\") {\r\n        if(this.updateCodeEventActive)\r\n          this.$socket.client.emit(\"updateCode\", this.pack(changeObj));\r\n      }\r\n      this.firstLoad = false;\r\n    },\r\n    updateCursorLocation() {\r\n      const cmWidth = document.getElementById(\"codemirror\").offsetWidth;\r\n      const cmHeight = document.getElementById(\"codemirror\").offsetHeight;\r\n      console.log(cmHeight);\r\n\r\n      const elemento = document.getElementsByClassName(\"CodeMirror-scroll\")[0];\r\n\r\n      const top =\r\n        document.getElementById(\"codemirror\").getBoundingClientRect().top +\r\n        this.cursorTopPosition +\r\n        5 -\r\n        elemento.scrollTop;\r\n      const left =\r\n        document.getElementById(\"codemirror\").getBoundingClientRect().left +\r\n        this.cursorLeftPosition +\r\n        30 -\r\n        elemento.scrollLeft;\r\n      console.log(top);\r\n      console.log(cmHeight);\r\n      if (cmWidth > left) {\r\n        this.$refs.pairCursor.style.left = left + \"px\";\r\n      }\r\n      if (cmHeight > top) {\r\n        this.$refs.pairCursor.style.top = top + \"px\";\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    cmEditor() {\r\n      return this.$refs.cmEditor.codemirror;\r\n    },\r\n  },\r\n  mounted() {\r\n    dbg(\"mounted - init\");\r\n\r\n    this.$refs.cmEditor.codemirror.on(\"change\", this.onCmCodeChange);\r\n    this.$refs.cmEditor.codemirror.on(\"cursorActivity\", this.cursorActivity);\r\n    const elemento = document.getElementsByClassName(\"CodeMirror-scroll\")[0];\r\n    elemento.addEventListener(\"scroll\", this.handleScroll);\r\n\r\n    // Cursor functionaliy disabled\r\n    /*let toggle = true;\r\n    setInterval(function() {\r\n      if (toggle) {\r\n        document.getElementById(\"pairCursor\").classList.add(\"invisible\");\r\n      } else {\r\n        document.getElementById(\"pairCursor\").classList.remove(\"invisible\");\r\n      }\r\n      toggle = !toggle;\r\n    }, 750);*/\r\n\r\n    // Disable ctrl+s shortkey in Windows or Linux\r\n    document.body.addEventListener('keydown', event => {\r\n     if (event.ctrlKey || event.metaKey) {\r\n      switch (String.fromCharCode(event.which).toLowerCase()) {\r\n        case \"s\":\r\n          event.preventDefault();\r\n          break;\r\n      }\r\n     }\r\n    });\r\n\r\n    this.$refs.timeBar.style.width = `${((this.maxTime - this.timePassed) /\r\n      this.maxTime) *\r\n      100}%`;\r\n\r\n    if (localStorage.demoExercise) {\r\n      this.loadDemoExercise();\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    dbg(\"beforeDestroy - init\");\r\n    window.removeEventListener(\"resize\", this.handleScroll);\r\n    const elemento = document.getElementsByClassName(\"CodeMirror-scroll\")[0];\r\n    if (elemento) {\r\n      elemento.removeEventListener(\"scroll\", this.handleScroll);\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.CodeMirror {\r\n  border: 1px solid #eee;\r\n  height: 50vh !important;\r\n}\r\n#pairCursor {\r\n  width: 2px;\r\n  height: 19px;\r\n  z-index: 9999;\r\n}\r\n</style>\r\n"]}]}